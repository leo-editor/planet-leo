<?xml version="1.0" ?><entry xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:leo-editor.github.io,2013-09-20:custom_printing.html</id><link href="http://leo-editor.github.io/custom_printing.html" rel="alternate" type="text/html"/><title>Custom Printing with printing.py</title><summary type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p>Printing with the printing.py plugin is fairly simple, and decently flexible.  However, sometimes you want more fine-grained control over the output of your print job.  For these situations, you can use a script.</p>
<div class="section" id="step-0-get-your-imports-right">
<h2>Step 0: Get your imports right</h2>
<p>We'll be using stuff from PyQt for this, specifically QtGui.  Be sure to import them at the top of your script:</p>
<pre class="literal-block">from PyQt4 import QtGui
</pre>
</div>
<div class="section" id="step-1-creating-your-document">
<h2>Step 1: Creating your Document</h2>
<p>Printing in Leo is handled by PyQt, which provides nice tools for printing QTextDocuments, which are in turn just HTML documents wrapped in a special object.</p>
<p>To that effect, we create our document (what follows is just a minimal example):</p>
<pre class="literal-block">mydoc = '''
&lt;html&gt;
&lt;h1&gt;Hello!&lt;/h1&gt;
&lt;p&gt;Documents to be printed in Leo are just HTML documents, wrapped up in a QTextDocument object.&lt;/p&gt;
&lt;/html&gt;
'''
</pre>
<p>Note that the above string can be <em>any</em> valid HTML.</p>
<p>And then we wrap it in a QTextDocument:</p>
<pre class="literal-block">qtextdoc = QtGui.QTextDocument()
qtextdoc.setHtml(mydoc)
</pre>
</div>
<div class="section" id="step-2-print-it">
<h2>Step 2: Print it!</h2>
<p>Finally, we use the printing.py plugin to preview the document to be printed:</p>
<pre class="literal-block">c.thePrintingController.print_preview_doc(qtextdoc)
</pre>
<p>You can see how the document would look when printed, and if you're satisfied, you can click on the print button from here.  If not, close the dialog, and nothing will be printed.  Easy as pie!</p>
</div>
<div class="section" id="the-full-script">
<h2>The full script</h2>
<p>Here's the full script:</p>
<pre class="literal-block">@language python
 from PyQt4 import QtGui

 mydoc = '''
 &lt;html&gt;
 &lt;h1&gt;Hello!&lt;/h1&gt;
 &lt;p&gt;Documents to be printed in Leo are just HTML documents, wrapped up in a QTextDocument object.&lt;/p&gt;
 &lt;/html&gt;
 '''

 qtextdoc = QtGui.QTextDocument()
 qtextdoc.setHtml(mydoc)

 c.thePrintingController.print_preview_doc(qtextdoc)
</pre>
</div>
<div class="section" id="optional-stylesheets">
<h2>Optional: Stylesheets</h2>
<p>QTextDocuments can be styled by CSS stylesheets, if you desire.  You can incorporate those with a call to qtextdoc.setDefaultStyleSheet, which takes in a string.  For example:</p>
<pre class="literal-block">css = '''
h1 {color: #f00}
p {color: #0f0}
'''
qtextdoc.setDefaultStyleSheet(css)
</pre>
</div></div></summary><updated planet:format="September 19, 2013 10:00 PM">2013-09-19T22:00:00Z</updated><category term="plugins"/><author><name>Jacob Peck</name></author><source><id>http://leo-editor.github.io/</id><link href="http://leo-editor.github.io/" rel="alternate" type="text/html"/><link href="http://leo-editor.github.io/feeds%5Call.atom.xml" rel="self" type="application/atom+xml"/><title>Leo Blog</title><updated planet:format="November 27, 2013 11:00 PM">2013-11-27T23:00:00Z</updated><planet:activity_threshold>0</planet:activity_threshold><planet:faceheight>79</planet:faceheight><planet:format>atom10</planet:format><planet:facewidth>65</planet:facewidth><planet:http_last_modified>Thu, 28 Nov 2013 23:42:47 GMT</planet:http_last_modified><planet:face>leo_65x79.png</planet:face><planet:name>Official Leo Editor Blog</planet:name><planet:css-id>official-leo-editor-blog</planet:css-id><planet:bozo>false</planet:bozo><planet:http_status>200</planet:http_status></source></entry>