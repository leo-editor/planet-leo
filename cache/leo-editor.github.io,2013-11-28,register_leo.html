<?xml version="1.0"?>
<entry xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:leo-editor.github.io,2013-11-28:register_leo.html</id><link href="http://leo-editor.github.io/register_leo.html" rel="alternate" type="text/html"/><title>Registering Leo with Windows</title><summary type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p><em>a post in progress</em></p>
<p>Installing Leo using the standard setup program from Sourceforge does nice things like create Start Menu &amp; Desktop shortcuts and enable open Leo files with a simple double-click. For those that like to run from source code or a portable drive there are <a href="http://leoeditor.com/installing.html#installing-from-sources-windows">manual instructions</a> for doing the same, but it's fiddly and rapidly gets old. Why repeat when automation is possible?</p>
<p>Introducing <strong><a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/register-leo.leox">register-leo.leox</a></strong> (and <a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/unregister-leo.leox">unregister-leo</a>): which creates the necessary Windows registry keys for integration with Explorer and friends. After running this script .leo and .leox files are shown with the Leo icon, and double-clicking on them will open them in Leo.</p>
<p>To use: open a command shell with administrative rights, and run:</p>
<div class="highlight"><pre>    d:\path\to\python.exe d:\path\to\leo\launchLeo.py e:\path\to\register-leo.leox
</pre></div>


<p>All in one step: you can try the <a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/elevate.py"><code>elevate.py</code></a> script which will ask for Admin privileges from a regular command shell:</p>
<div class="highlight"><pre>    d:\path\to\python.exe d:\path\to\leo\leo\scripts\elevate.py e:\path\to\register-leo.leox
</pre></div>


<p>Eventually I'd like to see this activated from a Settings/Options/Preferences menu. Then we can distribute daily and portable builds of Leo and still have easy (dis)integration with the host (on Windows) and not rely so heavily on stable builds and installers, which are few and long between 'cause of the pain in building them.</p>
<p>Developed and tested with Python 2.7, Leo 4.10 and Win7 x64. Py3 needs work.</p>
<p>Feedback/testing/patches welcome (see mailing list).</p>
<p>-Matt Wilkie</p>
<hr/>
<h2>Notes</h2>
<h4>What's this <code>.leox</code>?</h4>
<p>I created this convention so I could easily distinguish regular Leo files, which can be about anything, and Leo files which are runnable Leo scripts. The intention is to allow for things like:</p>
<div class="highlight"><pre>    leo --script d:\path\to\scripts\register-leo.leox
</pre></div>


<p>At present double-clicking a .leox opens in edit mode. It occurs to me as I write this it could be changed so it runs automatically by adding, <code>--script</code> (quotes might need fiddling with):</p>
<div class="highlight"><pre><span class="n">ftype</span> <span class="n">LeoFile</span><span class="o">=</span><span class="s">"C:\Python27\python.exe"</span> <span class="s">"B:</span><span class="se">\a</span><span class="s">pps\leo\launchLeo.py"</span> <span class="s">"--script ""%1"" %*</span>
</pre></div>


<h4>Any .leo is a launcher</h4>
<p>Association has the added benefit of removing the need for most to create a batch file and then figure out where in PATH to store it in order to use Leo. As a matter of fact, any .leo file becomes the equivalent of launchLeo.py, just try this:</p>
<div class="highlight"><pre><span class="c">%homedrive%\homepath%\workbook.leo x:\path\to\some\other\leofile.leo</span>
</pre></div>


<p>or to build on the previous note:</p>
<div class="highlight"><pre><span class="c">%homedrive%\homepath%\workbook.leo --script ..\scripts\unregister-leo.leox</span>
</pre></div>


<h3>Resources used</h3>
<p>http://superuser.com/questions/88491/force-cmd-exe-to-run-as-admin/<br/>
http://stackoverflow.com/questions/2331690/how-to-set-a-icon-file-while-creating-file<br/>
http://stackoverflow.com/questions/771689/how-can-i-set-an-icon-for-my-own-file-extension</p></div></summary><updated planet:format="November 27, 2013 11:00 PM">2013-11-27T23:00:00Z</updated><category term="Windows"/><category term="install"/><category term="scripts"/><author><name>Matt Wilkie</name></author><source><id>http://leo-editor.github.io/</id><link href="http://leo-editor.github.io/" rel="alternate" type="text/html"/><link href="http://leo-editor.github.io/feeds%5Call.atom.xml" rel="self" type="application/atom+xml"/><title>Leo Blog</title><updated planet:format="November 27, 2013 11:00 PM">2013-11-27T23:00:00Z</updated><planet:activity_threshold>0</planet:activity_threshold><planet:faceheight>79</planet:faceheight><planet:format>atom10</planet:format><planet:facewidth>65</planet:facewidth><planet:http_last_modified>Thu, 28 Nov 2013 23:42:47 GMT</planet:http_last_modified><planet:face>leo_65x79.png</planet:face><planet:name>Official Leo Editor Blog</planet:name><planet:css-id>official-leo-editor-blog</planet:css-id><planet:bozo>false</planet:bozo><planet:http_status>200</planet:http_status></source></entry>

