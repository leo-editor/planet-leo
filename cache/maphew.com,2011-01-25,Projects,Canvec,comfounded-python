<?xml version="1.0" ?><entry xml:lang="En" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:www.maphew.com,2011-01-25:/Projects/Canvec/comfounded-python</id><link href="http://www.maphew.com/Projects/Canvec/comfounded-python/" rel="alternate" type="text/html"/><title xml:lang="En">COMfounded python</title><content type="xhtml" xml:lang="En"><div xmlns="http://www.w3.org/1999/xhtml"><p>I think my python-COM environment is messed up.</p>
<p><strong>Got</strong></p>
<div class="highlight"><pre><span class="n">D</span><span class="p">:</span><span class="o">\&gt;</span> <span class="n">python</span> <span class="n">list</span><span class="o">-</span><span class="n">fc</span><span class="p">.</span><span class="n">py</span>
<span class="p">.</span><span class="o">./</span><span class="n">Scratch</span><span class="o">/</span><span class="n">blank_canvec</span><span class="p">.</span><span class="n">gdb</span>
<span class="o">&lt;</span><span class="n">COMObject</span> <span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;&gt;</span>
</pre></div>


<p>and <strong>expected</strong>something <a href="http://bit.ly/cfvwxY" title="http://bit.ly/cfvwxY">like
this</a>:</p>
<p>../Scratch/blank_canvec.gdb\
 [u'counties.shp', u'roads.shp']\
 counties.shp\
 roads.shp</p>
<h6>Possible culprits:</h6>
<p><img alt="" src="http://www.maphew.com/files/56/%3dstatic-python-dlls.png"/></p>
<ul>
<li>using Mark Cederholm's
    <a href="http://gis.stackexchange.com/questions/80/how-do-i-access-arcobjects-from-python" title="http://gis.stackexchange.com/questions/80/how-do-i-access-arcobjects-from-python">python+arcobjects</a>
    recipe requires registering com stuff, which conflicts wth
    PythonWin's com stuff.</li>
<li>I'm using <a href="http://www.yukongis.ca/How_To/Upgrading_ArcGIS_Python" title="http://www.yukongis.ca/How_To/Upgrading_ArcGIS_Python">Arcgis with python
    2.6</a>
    instead of the shipped 2.5. This hasn't proved problematic before,
    but maybe I just haven't wondered into this section of the forest
    before (which means IÂ need to <a href="http://www.maphew.com\Projects\Canvec\Search_PATH_for_duplicates.html" title="Projects/Search PATH for duplicates">eat crow for Jason
    Scheirer</a>).</li>
<li>I have concurrent python 2.5 and python 2.6 installs, 32 and 64bit,
    and they are walking over each other</li>
<li>one of the many other programs which distribute static python dll's
    is in path and colliding</li>
<li>I'm just very poor snake charmer. :)</li>
</ul>
<h5>Troubleshooting</h5>
<p>Win32 bug#3076741, <a href="https://sourceforge.net/tracker/?func=detail&amp;aid=3076741&amp;group_id=78018&amp;atid=551954" title="https://sourceforge.net/tracker/?func=detail&amp;aid=3076741&amp;group_id=78018&amp;atid=551954">&quot;This object does not support
enumeration&quot;</a>.
Using win32com.client.gencache registers com objects on the fly, fixes
one problem and creates others.</p>
<h6>update, 2011 Jan 25</h6>
<p>I think I've narrowed it to the win32 extension, as presented by the
<a href="http://www.yukongis.ca/How_To/Upgrading_ArcGIS_Python" title="http://www.yukongis.ca/How_To/Upgrading_ArcGIS_Python">arcgisscripting</a>wrapper.</p>
<p>I uninstalled all versions of python and cleared all directories from
PATH that had any kind of python??.dll, then installed python 2.5.4, and
numpy from the arcgis dvd (as per <a href="http://blogs.esri.com/Dev/blogs/geoprocessing/archive/2009/05/12/Using-Python-2.5.4-with-ArcGIS-9.3.1.aspx" title="http://blogs.esri.com/Dev/blogs/geoprocessing/archive/2009/05/12/Using-Python-2.5.4-with-ArcGIS-9.3.1.aspx">instructions
here</a>).
If <em>PYTHONPATH</em> contains ...\ArcGIS\bin, then we get the expected
results, if not, and we add arcgisscripting.py to Lib\site-packages:
win32com not found. If we then install the win32com package we get the
\&lt;COMObject \&lt;unknown&gt;&gt; error.</p>
<p>The readme for PythonWin on the install dvd says <em>&quot;ArcGIS no longer
installs PythonWin because the recommended methodology for creating the
geoprocessor has changed to using a new Python module that ESRI has
developed ...&quot;.</em></p>
<p>Sooooo, arcgisscripting.py and win32com work for most things, but not
for gp.ListFields() or gp.ListFeatureClasses() functions. I bet this
also applies to other list functions too, see <a href="http://resources.arcgis.com/content/kbase?fa=articleShow&amp;d=34873" title="http://resources.arcgis.com/content/kbase?fa=articleShow&amp;d=34873">changes in list
methods</a>
knowledgebase article. This means that python 2.6 and 2.7 can be used
with ArcGIS 9.x, but only if you stay away from the list functions.</p></div></content><updated planet:format="January 25, 2011 08:00 AM">2011-01-25T08:00:00Z</updated><category term="gis"/><category term="canvec"/><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><source><id>tag:www.maphew.com,2011-06-11:/atom/</id><icon>http://www.maphew.com/favicon.ico</icon><logo>http://www.maphew.com/feed-logo.png</logo><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><link href="http://www.maphew.com/" rel="alternate" type="text/html"/><link href="http://www.maphew.com/atom/" rel="self" type="application/atom+xml"/><title xml:lang="En">a hewer of maps</title><updated planet:format="May 17, 2013 08:54 AM">2013-05-17T08:54:00Z</updated><planet:format>atom10</planet:format><planet:http_etag>&quot;2699bcc-1a063-4ec5e8c135200&quot;</planet:http_etag><planet:http_last_modified>Sat, 30 Nov 2013 05:52:08 GMT</planet:http_last_modified><planet:bozo>true</planet:bozo><planet:activity_threshold>0</planet:activity_threshold><planet:facewidth>65</planet:facewidth><planet:faceheight>85</planet:faceheight><planet:http_status>200</planet:http_status></source></entry>