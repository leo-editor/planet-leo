<?xml version="1.0" ?><entry xml:lang="En" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:www.maphew.com,2013-03-17:/web-dev/deploy-website-with-rsync</id><link href="http://www.maphew.com/web-dev/deploy-website-with-rsync/" rel="alternate" type="text/html"/><title xml:lang="En">Deploy website with rsync</title><content type="xhtml" xml:lang="En"><div xmlns="http://www.w3.org/1999/xhtml"><p><em>Recipe for copying my Acrylamid-generated static html website to my webhost (<a href="http://www.nearlyfreespeech.net">nearlyfreespeech.net</a>).</em></p>
<p>In a nutshell, I use <a href="http://qtdtools.doering-thomas.de/page.php?seite=0&amp;sub=0&amp;lang=en">QtdSync</a> to generate the basic rsync update script, and then add rsync advanced options as make sense to me. From QtdSync's progress screen the rsync command line can be copied and pasted to create a batch file (strip the <code>-e ... sshpass...</code> line for interactive password prompting).</p>
<p>QtdSync is a bit twitchy around the <em>&quot;backup/don't backup into subfolder&quot;</em> options. Sometimes they appear to have the opposite effect of what they say. I still found it much easier than trying to construct the appropriate rsync script from scratch myself, just test on a small data set until the settings are ironed out. The backup set <code>.qtd</code> files are straightforward XML so it's pretty easy to check the results of your settings.</p>
<h5>QtdSync hard coded rsync options</h5>
<p>These are always used.</p>
<p><code>-rltv</code> which means:<br/>
<code>--recursive</code><br/>
<code>--links</code> - <em>copy symlinks as symlinks</em><br/>
<code>--times</code> - <em>preserve modification times</em><br/>
<code>--verbose</code></p>
<p><code>--progress</code> - <em>show progress</em></p>
<h5>QtdSync editable advanced rsync options</h5>
<p><code>--delete</code> - <em>delete extraneous files from destination dirs</em><br/>
<code>--force</code> - <em>force deletion of directories even if not empty</em>  <br/>
<code>--ignore-errors</code> - <em>delete even if there are I/O errors</em><br/>
<code>--hard-links</code> - <em>preserve hard links</em></p>
<h5>Extended rsync options</h5>
<p>Add these in the <em>Rsync Expert Settings</em> pane. When added as Task they override the global settings.</p>
<p><code>--compress</code> - <em>compress file data during the transfer</em>, saves bandwidth, speeds up transfers, 'nuff said</p>
<p><code>--skip-compress=%_ignore_ext%</code> - <em>skip compressing files with a suffix in LIST</em>, not yet using, but seems like a good idea</p>
<p><code>--checksum</code> - <em>skip based on checksum, not mod-time &amp; size</em>, because preserving timestamps between Windows and 'nix doesn't always work. I suspect it's faster to use <code>--modify-window=NUM</code> with a window like 2secs (that's what <a href="http://xxcopy.com"><code>xxcopy /ff</code></a> uses) but I'm not that concerned with performance and checksum should be more reliable.</p>
<p>For these next two, if something goes wrong the website will stay in previous state. Not quite the same as atomic updates in a db but close enough for me.<br/>
<code>--delay-updates</code> - <em>put all updated files into place at transfer's end</em><br/>
<code>--delete-delay</code> - <em>find deletions during, delete after</em></p>
<p><code>--human-readable</code> - <em>output numbers in a human-readable format</em></p></div></content><updated planet:format="March 17, 2013 08:00 AM">2013-03-17T08:00:00Z</updated><category term="web-dev"/><category term="technical"/><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><source><id>tag:www.maphew.com,2011-06-11:/atom/</id><icon>http://www.maphew.com/favicon.ico</icon><logo>http://www.maphew.com/feed-logo.png</logo><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><link href="http://www.maphew.com/" rel="alternate" type="text/html"/><link href="http://www.maphew.com/atom/" rel="self" type="application/atom+xml"/><title xml:lang="En">a hewer of maps</title><updated planet:format="May 17, 2013 08:54 AM">2013-05-17T08:54:00Z</updated><planet:format>atom10</planet:format><planet:http_etag>&quot;2699bcc-1a063-4ec5e8c135200&quot;</planet:http_etag><planet:http_last_modified>Sat, 30 Nov 2013 05:52:08 GMT</planet:http_last_modified><planet:bozo>true</planet:bozo><planet:activity_threshold>0</planet:activity_threshold><planet:facewidth>65</planet:facewidth><planet:faceheight>85</planet:faceheight><planet:http_status>200</planet:http_status></source></entry>