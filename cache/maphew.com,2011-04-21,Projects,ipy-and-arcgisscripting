<?xml version="1.0" ?><entry xml:lang="En" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:www.maphew.com,2011-04-21:/Projects/ipy-and-arcgisscripting</id><link href="http://www.maphew.com/Projects/ipy-and-arcgisscripting/" rel="alternate" type="text/html"/><title xml:lang="En">ipy and arcgisscripting</title><content type="xhtml" xml:lang="En"><div xmlns="http://www.w3.org/1999/xhtml"><p>….some further experiments with
<a href="http://ipython.scipy.org/" title="http://ipython.scipy.org/">ipython</a>and
<a href="http://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?id=709&amp;pid=706&amp;topicname=Writing_Python_scripts" title="http://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?id=709&amp;pid=706&amp;topicname=Writing_Python_scripts">ArcGIS
python</a>
geoprocessing. Here is a simple script to convert a bunch of coverages
to shapefile. There are 9 coverages occupying 3mb, it takes about 6
minutes, consumes 2 processors to 80-90% capacity and chews through
300mb of ram:</p>
<blockquote>
<div class="highlight"><pre><span class="n">cd</span> <span class="n">w</span><span class="p">:</span><span class="o">/</span><span class="n">Env</span><span class="o">-</span><span class="n">dat</span><span class="p">.</span>003<span class="o">/</span>2007<span class="o">-</span><span class="n">March</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">envy_ed2import</span> <span class="n">arcgisscripting</span>
<span class="n">gp</span> <span class="p">=</span> <span class="n">arcgisscripting</span><span class="p">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">gp</span><span class="p">.</span><span class="n">Workspace</span> <span class="p">=</span> ‘<span class="o">./</span>’

<span class="n">todo</span> <span class="p">=</span> !<span class="n">dir</span> <span class="o">/</span><span class="n">b</span> <span class="n">fwtc</span><span class="o">*</span>

<span class="k">for</span> <span class="n">cov</span> <span class="n">in</span> <span class="n">todo</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">print</span> <span class="n">cov</span>
      <span class="n">gp</span><span class="p">.</span><span class="n">FeatureClassToShapefile</span><span class="p">(</span> <span class="n">cov</span> <span class="o">+</span> ‘<span class="o">/</span><span class="n">arc</span>’<span class="p">,</span> ‘<span class="o">./</span><span class="n">shp</span>’<span class="p">)</span>
   <span class="n">except</span><span class="p">:</span>
      <span class="n">print</span> <span class="n">gp</span><span class="p">.</span><span class="n">GetMessages</span><span class="p">()</span>
</pre></div>


</blockquote>
<p>Contrast that to using
<a href="http://www.fwtools.org/" title="http://www.fwtools.org/">fwtools</a>
<a href="http://www.gdal.org/ogr/ogr2ogr.html" title="http://www.gdal.org/ogr/ogr2ogr.html">ogr2ogr</a>,
which takes 10 seconds:</p>
<blockquote>
<div class="highlight"><pre><span class="k">for</span> <span class="c">%a in (fwtc*) do ogr2ogr -f “esri shapefile” ogr\%a %a</span>
</pre></div>


</blockquote>
<p>The problem is, ogr2ogr doesn’t currently translate everything arcpy
does. It leaves behind the metadata and fills voids (though these can be
filtered out later as the attributes are empty, but that is an extra
step). There’s also no way (that I can see) to select only arcs or only
points.</p>
<h5>(June 6th) another episode in the ogr vs arcgis battle:</h5>
<p>Goal: <strong><em>Project 70 shapefiles in various subdirectories occupying
300mb</em></strong>.</p>
<h6><strong>ArcGIS BatchProject interactively:</strong></h6>
<ul>
<li>search catalog for k:\incoming\NHN*.shp</li>
<li>fire up Batch Project toolbox</li>
<li>drag’n'drop search results (wait 2+ minutes for verification step to
    complete)</li>
<li>run</li>
<li>oops, error in selected projection parameters. failed.</li>
<li>try again, this time using Command Line Window to see what’s going
    on. (2+ minutes for verification)</li>
<li>figure out problem, fix parameters (2+ min for verification, which
    repeats every time you attempt to Insert Variable or other command
    change)</li>
<li>execute the command. (Finished in 21 minutes, 43 seconds.)</li>
</ul>
<p><strong>total arc time: &gt;45 minutes.</strong></p>
<h6><strong>ogr2ogr:</strong></h6>
<ul>
<li>research command syntax, examine old notes and scripts (5 minutes)</li>
<li>build and test command line (2 minutes)</li>
<li>execute (7 minutes, 12 seconds)</li>
</ul>
<p><strong>total ogr time: \~15 minutes.</strong>So even if we subtract the debugging
time for the problematic projection parameters (which have never caused
me trouble before, but that is another story), ogr is still twice as
fast. Which could be 3 times as fast if the command syntax were
internalized and I didn’t have to look it up. Guess where I’m going to
be spending some optimisation energy!</p>
<p>And now for the initial impetus for posting this comment, saving my
command line!</p>
<blockquote>
<div class="highlight"><pre><span class="k">for</span> <span class="o">/</span><span class="n">r</span> <span class="c">%a in (nhn*.shp) do @ogr2ogr ogr %a -t_srs z:\Arcutils\prj\YkAlbers.proj4</span>
</pre></div>


</blockquote></div></content><updated planet:format="April 21, 2011 08:00 AM">2011-04-21T08:00:00Z</updated><category term="projects"/><category term="gis"/><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><source><id>tag:www.maphew.com,2011-06-11:/atom/</id><icon>http://www.maphew.com/favicon.ico</icon><logo>http://www.maphew.com/feed-logo.png</logo><author><name>matt wilkie</name><email>maphew+website@gmail.com</email><uri>http://www.maphew.com/</uri></author><link href="http://www.maphew.com/" rel="alternate" type="text/html"/><link href="http://www.maphew.com/atom/" rel="self" type="application/atom+xml"/><title xml:lang="En">a hewer of maps</title><updated planet:format="May 17, 2013 08:54 AM">2013-05-17T08:54:00Z</updated><planet:format>atom10</planet:format><planet:http_etag>&quot;2699bcc-1a063-4ec5e8c135200&quot;</planet:http_etag><planet:http_last_modified>Sat, 30 Nov 2013 05:52:08 GMT</planet:http_last_modified><planet:bozo>true</planet:bozo><planet:activity_threshold>0</planet:activity_threshold><planet:facewidth>65</planet:facewidth><planet:faceheight>85</planet:faceheight><planet:http_status>200</planet:http_status></source></entry>